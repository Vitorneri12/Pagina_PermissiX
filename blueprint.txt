BLUEPRINT COMPLETO DO SISTEMA CERTX

  ğŸ“‹ VISÃƒO GERAL

  CertX Ã© um sistema de gerenciamento de DeclaraÃ§Ãµes de Conformidade (DCs) para instrumentos de mediÃ§Ã£o, desenvolvido com arquitetura moderna e containerizada.

  ---
  ğŸ—ï¸ ARQUITETURA DO SISTEMA

  Stack TecnolÃ³gico

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚    FRONTEND     â”‚     BACKEND     â”‚   BANCO DADOS   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ React 19        â”‚ Node.js/Express â”‚ PostgreSQL 15   â”‚
  â”‚ Vite            â”‚ Prisma ORM      â”‚                 â”‚
  â”‚ React Router 7  â”‚ JWT Auth        â”‚                 â”‚
  â”‚ Lucide Icons    â”‚ Multer/PDF-lib  â”‚                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Infraestrutura (Docker)

  Services:
  â”œâ”€â”€ Frontend (Port 8080) - React SPA
  â”œâ”€â”€ Backend (Port 3333) - API REST
  â””â”€â”€ Database (Port 5434) - PostgreSQL

  Networks: certx-network (bridge)
  Volumes: pgdata (persistent storage)

  ---
  ğŸ“Š MODELO DE DADOS

  Entidades Principais

  â”Œâ”€â”€â”€ EMPRESAS â”€â”€â”€â”€â”    â”Œâ”€â”€â”€ USUARIOS_CUSTOM â”€â”€â”€â”€â”
  â”‚ â€¢ id            â”‚â”€â”€â”€â”€â”‚ â€¢ id                   â”‚
  â”‚ â€¢ nome          â”‚    â”‚ â€¢ nome, email, senha   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â€¢ empresa_id (FK)      â”‚
                         â”‚ â€¢ ativo, reset_token   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
      â”Œâ”€â”€â”€ DCS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ â€¢ id, id_usuario (FK)     â”‚               â”‚
      â”‚ â€¢ empresa_id (FK)         â”‚               â”‚
      â”‚ â€¢ status, estimativa_gru  â”‚               â”‚
      â”‚ â€¢ datas (criacao, envio)  â”‚               â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
                  â”‚                               â”‚
  â”Œâ”€â”€â”€ INSTRUMENTOS â”€â”€â”€â”€â”    â”Œâ”€â”€â”€ SOLICITACOES_API â”€â”´â”€â”€â”
  â”‚ â€¢ id_dc (FK)        â”‚    â”‚ â€¢ id_usuario (FK)       â”‚
  â”‚ â€¢ tipo, marca       â”‚    â”‚ â€¢ id_dc (FK)            â”‚
  â”‚ â€¢ modelo, serie     â”‚    â”‚ â€¢ payload, resposta     â”‚
  â”‚ â€¢ capacidades       â”‚    â”‚ â€¢ cnpj, razao_social    â”‚
  â”‚ â€¢ status, taxa      â”‚    â”‚ â€¢ endereco, municipio   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸš€ FUNCIONALIDADES IMPLEMENTADAS

  ğŸ” AutenticaÃ§Ã£o & AutorizaÃ§Ã£o

  - Login/Logout com JWT
  - RecuperaÃ§Ã£o de senha via email
  - RedefiniÃ§Ã£o de senha com token
  - Sistema de empresas multi-tenant
  - Middleware de autenticaÃ§Ã£o

  ğŸ‘¤ GestÃ£o de UsuÃ¡rios

  - Cadastro de usuÃ¡rios
  - Perfil do usuÃ¡rio editÃ¡vel
  - VinculaÃ§Ã£o empresa-usuÃ¡rio
  - AtivaÃ§Ã£o/desativaÃ§Ã£o de contas

  ğŸ“‹ Gerenciamento de DCs

  - CriaÃ§Ã£o de DeclaraÃ§Ãµes de Conformidade
  - Listagem e consulta de DCs
  - Estados do workflow: NOVA â†’ ENVIADA â†’ PROCESSADA
  - Estimativa de custos (GRU)
  - HistÃ³rico de modificaÃ§Ãµes

  ğŸ”§ GestÃ£o de Instrumentos

  - Cadastro de instrumentos por DC
  - Tipos: BalanÃ§as, Instrumentos Diversos
  - Dados tÃ©cnicos completos (sÃ©rie, capacidade, etc.)
  - Upload de documentos PDF
  - Status individual por instrumento

  ğŸŒ IntegraÃ§Ã£o Externa (API)

  - Sistema de solicitaÃ§Ãµes Ã  API externa
  - Payload estruturado para envio
  - Armazenamento de respostas
  - Rastreamento por CNPJ/empresa

  ---
  ğŸ—‚ï¸ ESTRUTURA DE ARQUIVOS

  Backend (/backend/)

  api/
  â”œâ”€â”€ controllers/     # LÃ³gica de negÃ³cio
  â”œâ”€â”€ routes/         # DefiniÃ§Ã£o de rotas
  â”‚   â”œâ”€â”€ auth.js     # AutenticaÃ§Ã£o
  â”‚   â”œâ”€â”€ dc.js       # DeclaraÃ§Ãµes
  â”‚   â””â”€â”€ empresas.js # Empresas
  â”œâ”€â”€ middleware/     # Middlewares (auth, validation)
  â”œâ”€â”€ services/       # ServiÃ§os (email, api externa)
  â””â”€â”€ validators/     # ValidaÃ§Ã£o de dados

  prisma/
  â”œâ”€â”€ schema.prisma   # Modelo de dados
  â””â”€â”€ migrations/     # MigraÃ§Ãµes do DB

  config/            # ConfiguraÃ§Ãµes
  scripts/           # Scripts auxiliares
  server.js          # Entrada da aplicaÃ§Ã£o

  Frontend (/frontend/)

  src/
  â”œâ”€â”€ components/     # Componentes reutilizÃ¡veis
  â”‚   â”œâ”€â”€ UserProfileMenu.jsx
  â”‚   â”œâ”€â”€ DCWorkflowStatus.jsx
  â”‚   â””â”€â”€ ModalRegistro.jsx
  â”œâ”€â”€ pages/          # PÃ¡ginas da aplicaÃ§Ã£o
  â”‚   â”œâ”€â”€ Login.jsx
  â”‚   â”œâ”€â”€ Cadastro.jsx
  â”‚   â”œâ”€â”€ DCList.jsx
  â”‚   â””â”€â”€ ConsultarDC.jsx
  â”œâ”€â”€ services/       # IntegraÃ§Ã£o com API
  â”œâ”€â”€ context/        # Context API (AuthContext)
  â”œâ”€â”€ utils/          # UtilitÃ¡rios
  â””â”€â”€ styles/         # Estilos CSS

  ---
  ğŸ”„ FLUXOS DE TRABALHO

  1. Fluxo de CriaÃ§Ã£o de DC

  Usuario â†’ Login â†’ Dashboard â†’ Nova DC â†’
  Adicionar Instrumentos â†’ Enviar â†’ Aguardar Processamento

  2. Estados da DC

  NOVA â†’ ENVIADA â†’ PROCESSADA
    â†“        â†“         â†“
  EditÃ¡vel  Readonly  Completa

  3. IntegraÃ§Ã£o API Externa

  DC Enviada â†’ Payload JSON â†’ API Externa â†’
  Resposta â†’ AtualizaÃ§Ã£o Status â†’ NotificaÃ§Ã£o

  ---
  ğŸš€ DEPLOY E CONFIGURAÃ‡ÃƒO

  VariÃ¡veis de Ambiente

  Root (.env)
  DB_PASSWORD=postgres
  JWT_SECRET=segredo123
  DB_PORT=5434

  Backend (.env)
  DATABASE_URL=postgresql://postgres:postgres@db:5432/certX-db
  JWT_SECRET=segredo123
  PORT=3333
  USE_AUTH=true
  NODE_ENV=production

  Frontend (.env)
  VITE_API_URL=/api
  VITE_USE_AUTH=true

  Comandos de Deploy

  # Deploy completo
  ./deploy.sh

  # Deploy manual
  docker-compose build
  docker-compose up -d
  docker-compose exec backend npx prisma migrate deploy

  ---
  ğŸ“‹ ENDPOINTS DA API

  AutenticaÃ§Ã£o (/api/auth)

  - POST /login - Login do usuÃ¡rio
  - POST /register - Cadastro
  - POST /forgot-password - Recuperar senha
  - POST /reset-password - Redefinir senha
  - GET /me - Dados do usuÃ¡rio logado

  DeclaraÃ§Ãµes (/api/dc)

  - GET / - Listar DCs do usuÃ¡rio
  - POST / - Criar nova DC
  - GET /:id - Consultar DC especÃ­fica
  - PUT /:id - Atualizar DC
  - POST /:id/instrumentos - Adicionar instrumento
  - POST /:id/enviar - Enviar DC para processamento

  Empresas (/api/empresas)

  - GET / - Listar empresas
  - POST / - Criar empresa

  ---
  ğŸ¯ FUNCIONALIDADES EM DESTAQUE

  1. Sistema Multi-tenant

  - Isolamento por empresa
  - UsuÃ¡rios vinculados a empresas especÃ­ficas
  - DCs organizadas por empresa

  2. Workflow Robusto

  - Estados bem definidos para DCs
  - Rastreamento de mudanÃ§as
  - Estimativas de custo automÃ¡ticas

  3. Upload e GestÃ£o de Arquivos

  - Upload de PDFs para instrumentos
  - Armazenamento seguro no backend
  - ValidaÃ§Ã£o de tipos de arquivo

  4. Interface Responsiva

  - Design moderno com React
  - Componentes reutilizÃ¡veis
  - Estados de loading e feedback

  5. SeguranÃ§a

  - JWT para autenticaÃ§Ã£o
  - Bcrypt para senhas
  - ValidaÃ§Ã£o de entrada
  - CORS configurado

  ---
  ğŸ› ï¸ PRÃ“XIMOS DESENVOLVIMENTOS SUGERIDOS

  Funcionalidades

  - Dashboard com mÃ©tricas
  - RelatÃ³rios em PDF
  - NotificaÃ§Ãµes por email
  - Sistema de permissÃµes por role
  - API para integraÃ§Ã£o externa

  Melhorias TÃ©cnicas

  - Testes automatizados
  - Logging estruturado
  - Monitoramento de performance
  - Cache Redis
  - Rate limiting

  UX/UI

  - Modo escuro
  - PWA (Progressive Web App)
  - Filtros avanÃ§ados
  - ExportaÃ§Ã£o de dados
  - Busca global

  ---
  Este blueprint representa um sistema robusto, escalÃ¡vel e moderno para gerenciamento de DeclaraÃ§Ãµes de Conformidade, pronto para produÃ§Ã£o e com arquitetura que facilita futuras expansÃµes.